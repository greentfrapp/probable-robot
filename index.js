import{c as N,d as m,r as C,o as l,a as u,b as g,e as h,M as V,s as R,f as c,w as T,v as B,t as q,F as S,g as z,n as w,h as D,i as v,j as M,k as A}from"./vendor.js";const j=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}};j();const O="https://jexpcababkrsoibblglb.supabase.co",H="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpleHBjYWJhYmtyc29pYmJsZ2xiIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDY3MDk1OTQsImV4cCI6MTk2MjI4NTU5NH0.F2MU8sqYQiQD2mF-jpm_jNoFssItWKTtWcRzrMPJgzc",K=N(O,H);var d=(e,t)=>{const o=e.__vccOpts||e;for(const[s,n]of t)o[s]=n;return o};const F=m({components:{SearchIcon:C}}),J={class:"fixed right-10 bottom-10 bg-gray-800 rounded-full p-2 drop-shadow-lg cursor-pointer border border-gray-100 border-2"};function U(e,t,o,s,n,r){const i=h("SearchIcon");return l(),u("div",J,[g(i,{class:"h-6 w-6 text-gray-100"})])}var Y=d(F,[["render",U]]);function P(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}const W=.9;async function Z(e){const t=new V({idField:"url",fields:["title","text"],storeFields:["url","title","text"],searchOptions:{boost:{title:100}}});return t.addAll(e.map(o=>({id:o.id,url:o.url,title:o.title,text:o.text}))),t}function k(e,t,o=-1,s=-1,n="<b>",r="</b>"){const i=R(e,[t],{returnMatchData:!0,threshold:W});if(!i.length)return{highlight:t,matchLength:0};const a=i[0].match.index,y=i[0].match.index+i[0].match.length,_=t.slice(a,y),L=new RegExp(`((.|
)*)(s|^|[^(A-Z|a-z|')])(.*?${P(_)})((.|
)*)`,"gi");function E(Re,b,Te,x,I,$){if(o<0&&s<0)return b+x+n+I+r+$;{let p=b,f=$;return o>0?p=b.split(/\s/).slice(-o).join(" "):o===0&&(p=""),s>0?f=$.split(/\s/).slice(0,s).join(" "):s===0&&(f=""),p.length<b.length&&(p="\u2026"+p),f.length<$.length&&(f=f+"\u2026"),p+x+n+I+r+f}}return{highlight:t.replace(L,E),matchLength:_.length}}const G=m({props:{modelValue:{type:String,default:""}},components:{SearchIcon:C},data(){return{}},computed:{inputValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},ctrlKey(){let e="";return navigator.platform?e=navigator.platform.toLowerCase():navigator.userAgentData&&(e=navigator.userAgentData.platform.toLowerCase()),e.includes("mac")||e.includes("iphone")||e.includes("ipad")?"\u2318":"Ctrl"}},methods:{focus(){this.$refs.input.focus()},unfocus(){this.$refs.input.blur()}}}),Q={class:"relative flex gap-4 p-4"},X={class:"flex items-center pointer-events-none"},ee={class:"hidden sm:flex absolute inset-y-0 right-4 text-xs text-gray-300 justify-center items-center"},te={class:"border rounded flex justify-center items-center py-0.5 px-1"};function se(e,t,o,s,n,r){const i=h("SearchIcon");return l(),u("div",Q,[c("div",X,[g(i,{class:"h-7 w-7 text-gray-400","aria-hidden":"true"})]),T(c("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=a=>e.inputValue=a),type:"text",placeholder:"Search...",class:"focus:ring-0 focus:border-0 focus-visible:outline-none p-0 w-full bg-transparent border-0"},null,512),[[B,e.inputValue]]),c("div",ee,[c("div",te,q(e.ctrlKey)+" + K",1)])])}var ne=d(G,[["render",se]]);const oe=m({emits:["close"],props:{results:{type:Array,default:[]},selected:{type:Number,default:0}},watch:{selected(e,t){var o,s;if(e!==-1&&e!==t){const n=(o=document.getElementById("catche-search"))==null?void 0:o.shadowRoot;(s=n==null?void 0:n.getElementById(`result-${e}`))==null||s.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}}}}),re={class:"text-gray-700 flex flex-col divide-y"},ie=["id","href"],le=["innerHTML"],ce=["innerHTML"],ae={key:0},ue={key:1,class:"px-5 py-4"};function he(e,t,o,s,n,r){return l(),u("div",re,[(l(!0),u(S,null,z(e.results,(i,a)=>(l(),u("a",{key:a,id:`result-${a}`,class:w(["px-5 py-4 hover:bg-gray-100 cursor-pointer flex flex-col gap-1",e.selected===a?"bg-gray-100":""]),href:i.url,onClick:t[0]||(t[0]=y=>e.$emit("close"))},[c("h1",{class:"text-xl truncate",innerHTML:i.title},null,8,le),c("p",{class:"truncate",innerHTML:i.text},null,8,ce)],10,ie))),128)),e.results.length?(l(),u("div",ae)):(l(),u("div",ue," No results "))])}var de=d(oe,[["render",he]]);const pe={},fe={class:"text-gray-300 flex gap-1 justify-end px-3 py-2 text-xs font-bold"},me=c("span",null,[D("Powered by "),c("a",{class:"text-gray-400",href:"https://try.catche.co"},"Catche")],-1),ye=[me];function ge(e,t){return l(),u("div",fe,ye)}var _e=d(pe,[["render",ge]]);const be=m({async mounted(){this.searcher=await Z(this.data),document.addEventListener("keydown",e=>{const t=e.key;if(t==="ArrowUp")e.preventDefault(),this.selected=Math.max(0,this.selected-1);else if(t==="ArrowDown")e.preventDefault(),this.selected=Math.min(Math.max(this.results.length-1,0),this.selected+1);else if(t==="Enter"){e.preventDefault();const o=this.results[this.selected].url;this.query="",this.selected=-1,this.open=!1,this.$emit("close"),setTimeout(()=>window.location.href=o,10)}},!1)},props:{show:{type:Boolean,default:!1},data:{type:Array,default:[]}},components:{SearchBox:ne,Results:de,Branding:_e},watch:{query(e){this.selected=e?0:-1,this.debounceTimerId&&clearTimeout(this.debounceTimerId),e?(this.open=!0,this.debounceTimerId=setTimeout(()=>{this.search()},this.debounceTimeout)):this.open=!1},show(e){e?this.$refs.searchBox.focus():this.$refs.searchBox.unfocus()}},data(){return{open:!1,query:"",searcher:null,numResults:10,results:[],selected:0,debounceTimerId:null,debounceTimeout:50}},methods:{search(){const e=performance.now(),t=this.searcher.search(this.query,{prefix:s=>s.length<=3,fuzzy:s=>s.length>3?.1:!1,combineWith:"AND"});let o=[];t.length<this.numResults&&(o=this.searcher.search(this.query,{prefix:s=>s.length<=3,fuzzy:s=>s.length>3?.3:!1,combineWith:"OR"}).filter(s=>!t.map(n=>n.url).includes(s.url))),this.results=t.concat(o).slice(0,this.numResults).map(s=>({url:s.url||"",title:k(this.query,s.title).highlight||"",text:k(this.query,s.text,3,10).highlight||""})),this.updateDebounce(performance.now()-e)},close(){this.open=!1,this.query="",this.$emit("close")},updateDebounce(e){this.debounceTimeout=.9*this.debounceTimeout+.1*e}}});function $e(e,t,o,s,n,r){const i=h("SearchBox"),a=h("Results"),y=h("Branding");return l(),u("div",{class:w(["font-sans w-full sm:w-128 max-w-full bg-white shadow-catche fixed top-0 sm:top-1/2 left-1/2 -translate-x-1/2 sm:-translate-y-1/2 sm:rounded-3xl flex flex-col divide-y overflow-hidden",[e.show?"opacity-100":"opacity-0 pointer-events-none",e.open?"h-96":"h-[3.75rem]"]]),style:{transition:"opacity 300ms, height 300ms"}},[g(i,{modelValue:e.query,"onUpdate:modelValue":t[0]||(t[0]=_=>e.query=_),ref:"searchBox"},null,8,["modelValue"]),g(a,{class:"h-96 overflow-y-scroll",results:e.results,onClose:e.close,selected:e.selected},null,8,["results","onClose","selected"]),g(y)],2)}var ve=d(be,[["render",$e]]);const we=m({mounted(){const e=document.querySelector("script[catche-key]");e&&(this.catcheKey=e.getAttribute("catche-key")),this.loadData().then(t=>this.data=t).then(()=>{document.addEventListener("keydown",t=>{const o=t.key;(t.ctrlKey||t.metaKey)&&o==="k"&&(t.preventDefault(),this.show=!this.show)},!1)})},components:{Icon:Y,SearchMenu:ve},data(){return{catcheKey:"00000000-0000-0000-0000-000000000000",show:!1,searcher:null,data:[]}},methods:{toggle(){this.show=!this.show},async loadData(){let{data:e,error:t}=await K.from("webpages_free").select().eq("catche_key",this.catcheKey);return t?(console.error(t),[]):e}}}),xe=D(" test "),Ie=c("div",{class:"h-screen bg-red-500"},null,-1),Me=c("div",{class:"h-screen bg-green-500"},null,-1),ke=c("div",{class:"h-screen bg-blue-500"},null,-1),Ce=c("div",{class:"h-screen bg-red-500"},null,-1);function Se(e,t,o,s,n,r){const i=h("Icon"),a=h("SearchMenu");return l(),u(S,null,[e.data.length?(l(),v(i,{key:0,onClick:e.toggle,style:{"z-index":"2147483645"}},null,8,["onClick"])):M("",!0),c("div",{class:w(["fixed top-0 left-0 bg-white h-screen w-screen transition-all duration-300",e.show?"opacity-80":"opacity-0 pointer-events-none"]),onClick:t[0]||(t[0]=y=>e.show=!1),style:{"z-index":"2147483646"}},null,2),e.data.length?(l(),v(a,{key:1,show:e.show,data:e.data,style:{"z-index":"2147483647"}},null,8,["show","data"])):M("",!0),xe,Ie,Me,ke,Ce],64)}var De=d(we,[["render",Se]]);const Le=m({components:{Main:De}});function Ee(e,t,o,s,n,r){const i=h("Main");return l(),v(i)}var Ne=d(Le,[["render",Ee]]);(function(){var r;const t=document.createElement("div");t.setAttribute("id","catche-search");const o=document.createElement("div"),s=document.createElement("link"),n=((r=t.attachShadow)==null?void 0:r.call(t,{mode:"open"}))||t;s.setAttribute("rel","stylesheet"),s.setAttribute("href","https://cdn.jsdelivr.net/gh/greentfrapp/probable-robot@0.0.8/index.css"),n.appendChild(s),n.appendChild(o),A(Ne).mount(o),document.body.appendChild(t)})();
