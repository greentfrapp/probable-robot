import{c as x,d as p,r as y,o as c,a as l,b as f,e as d,M as w,f as i,w as I,v as S,t as m,F as v,g as C,h as M,n as V,i as _,j as g,k}from"./vendor.71d44ffa.js";const A=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}};A();const B="https://jexpcababkrsoibblglb.supabase.co",N="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpleHBjYWJhYmtyc29pYmJsZ2xiIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDY3MDk1OTQsImV4cCI6MTk2MjI4NTU5NH0.F2MU8sqYQiQD2mF-jpm_jNoFssItWKTtWcRzrMPJgzc",D=x(B,N);var h=(e,s)=>{const t=e.__vccOpts||e;for(const[o,n]of s)t[o]=n;return t};const z=p({components:{SearchIcon:y}}),O={class:"fixed right-10 bottom-10 bg-gray-800 rounded-full p-2 drop-shadow-lg cursor-pointer border border-gray-100 border-2"};function q(e,s,t,o,n,r){const a=d("SearchIcon");return c(),l("div",O,[f(a,{class:"h-6 w-6 text-gray-100"})])}var E=h(z,[["render",q]]);async function R(e){const s=new w({idField:"url",fields:["title","desc","text"],storeFields:["url","title","desc","text","catched_at"],searchOptions:{boost:{title:100}}});return s.addAll(e.map(t=>({url:t.url,title:t.title,desc:t.desc,text:t.text,catched_at:t.catched_at}))),s}const j=p({props:{modelValue:{type:String,default:""}},components:{SearchIcon:y},data(){return{}},computed:{inputValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},ctrlKey(){let e="";return navigator.platform?e=navigator.platform.toLowerCase():navigator.userAgentData&&(e=navigator.userAgentData.platform.toLowerCase()),e.includes("mac")||e.includes("iphone")||e.includes("ipad")?"\u2318":"Ctrl"}}}),F={class:"relative flex gap-4 p-4"},J={class:"flex items-center pointer-events-none"},L={class:"absolute inset-y-0 right-0 text-xs text-gray-300 lg:flex justify-center items-center mr-4"},T={class:"inline border border-1 rounded flex justify-center items-center h-6 px-1"};function Y(e,s,t,o,n,r){const a=d("SearchIcon");return c(),l("div",F,[i("div",J,[f(a,{class:"h-7 w-7 text-gray-400","aria-hidden":"true"})]),I(i("input",{"onUpdate:modelValue":s[0]||(s[0]=u=>e.inputValue=u),type:"text",name:"query",class:"focus:ring-0 focus:border-white focus-visible:outline-none p-0 w-full z-10 bg-transparent"},null,512),[[S,e.inputValue]]),i("div",L,[i("div",T,m(e.ctrlKey)+" + K",1)])])}var K=h(j,[["render",Y]]);const U=p({props:{results:{type:Array,default:[]}},components:{SearchIcon:y}}),W={class:"text-gray-700 flex flex-col divide-y"},P=["href"],Q={class:"font-semibold"},Z={class:"truncate"};function X(e,s,t,o,n,r){return c(),l("div",W,[(c(!0),l(v,null,C(e.results,(a,u)=>(c(),l("a",{key:u,class:"px-5 py-4 hover:bg-gray-50 cursor-pointer",href:a.url},[i("h1",Q,m(a.title),1),i("p",Z,m(a.desc),1)],8,P))),128))])}var H=h(U,[["render",X]]);const G={},ee={class:"text-gray-300 flex gap-1 justify-end px-3 py-2 text-xs font-semibold"},te=i("span",null,[M("Powered by "),i("a",{class:"text-gray-400",href:"https://try.catche.co"},"Catche")],-1),se=[te];function ne(e,s){return c(),l("div",ee,se)}var oe=h(G,[["render",ne]]);const re=p({async mounted(){this.searcher=await R(this.data)},props:{show:{type:Boolean,default:!1},data:{type:Array,default:[]}},components:{SearchBox:K,Results:H,Branding:oe},watch:{query(e,s){e?(this.open=!0,this.search()):this.open=!1}},data(){return{open:!1,query:"",searcher:null,numResults:10,results:[]}},methods:{search(){const e=this.searcher.search(this.query,{prefix:t=>t.length<=3,fuzzy:t=>t.length>3?.2:null,combineWith:"AND"}).sort((t,o)=>{const n=o.score-t.score;return Math.abs(n)>5?n:o.catched_at-t.catched_at});let s=[];e.length<this.numResults&&(s=this.searcher.search(this.query,{prefix:t=>t.length<=3,fuzzy:t=>t.length>3?.2:null,combineWith:"OR"}).sort((t,o)=>{const n=o.score-t.score;return Math.abs(n)>5?n:o.catched_at-t.catched_at}).filter(t=>!e.map(o=>o.url).includes(t.url))),this.results=e.concat(s).slice(0,this.numResults).map((t,o)=>({url:t.url,title:t.title,highlightedTitle:t.title,desc:t.desc,text:t.text,catched_at:t.catched_at}))}}});function ae(e,s,t,o,n,r){const a=d("SearchBox"),u=d("Results"),$=d("Branding");return c(),l("div",{class:V(["font-sans fixed w-128 max-w-full bg-white shadow-catche top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-3xl flex flex-col divide-y overflow-hidden",[e.show?"opacity-100":"opacity-0 pointer-events-none",e.open?"h-96":"h-[3.75rem]"]]),style:{transition:"opacity 1s, height 500ms"}},[f(a,{modelValue:e.query,"onUpdate:modelValue":s[0]||(s[0]=b=>e.query=b)},null,8,["modelValue"]),f(u,{class:"h-96 overflow-y-scroll",results:e.results},null,8,["results"]),f($)],2)}var ce=h(re,[["render",ae]]);const ie=p({mounted(){const e=document.querySelector("script[domain]");e&&(this.domain=e.getAttribute("domain")),this.loadData().then(s=>this.data=s)},components:{Icon:E,SearchMenu:ce},data(){return{domain:"",show:!1,searcher:null,data:[]}},methods:{toggle(){this.show=!this.show},async loadData(){const e=performance.now();let{data:s,error:t}=await D.from("webpages_free").select().eq("root",this.domain);return t?(console.log(t),[]):(console.log(performance.now()-e),s)}}});function le(e,s,t,o,n,r){const a=d("Icon"),u=d("SearchMenu");return c(),l(v,null,[e.data.length?(c(),_(a,{key:0,onClick:e.toggle},null,8,["onClick"])):g("",!0),e.data.length?(c(),_(u,{key:1,show:e.show,data:e.data},null,8,["show","data"])):g("",!0)],64)}var de=h(ie,[["render",le]]);const ue=p({components:{Main:de}});function he(e,s,t,o,n,r){const a=d("Main");return c(),_(a)}var pe=h(ue,[["render",he],["__scopeId","data-v-017f3a66"]]);function fe(){var r;const e=document.getElementById("catche-search");e&&document.body.removeChild(e);const s=document.createElement("div");s.setAttribute("id","catche-search");const t=document.createElement("div"),o=document.createElement("link"),n=((r=s.attachShadow)==null?void 0:r.call(s,{mode:"closed"}))||s;o.setAttribute("rel","stylesheet"),o.setAttribute("href","https://catche-scripts.s3.amazonaws.com/index.c9f3c4c9.css"),n.appendChild(o),n.appendChild(t),k(pe).mount(t),document.body.appendChild(s)}fe();
